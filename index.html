<!DOCTYPE html>
<html>
<head>
	<title>CA</title>
	<style type="text/css">
		body, html {
			text-align: center;
			width:100%;
			height:100%;
			margin : 0;
		}

	</style>

	<script>
	function play() {
		var ctx;
		var rand = Math.random;
		var block_count = 30;
		var block_size = 8;
		var vel_init = 20;
		var friction_flr = 0.9;
		var friction_wall = 0.97;
		var blocks = [];
		var colors = ["#FFFFFF", "#2244FF"]; // cells colors
		var interval = 0;
		var c = document.getElementById('area');
		ctx = c.getContext('2d');
		ctx.canvas.width  = window.innerWidth;
  		ctx.canvas.height = window.innerHeight;
		interval = window.setInterval(simloop, 1000/30);

		for (var i = 0; i < block_count; i++) {	
			var pos = [rand() * ctx.canvas.width , rand() * ctx.canvas.height ];
			var vel = [rand() * vel_init - vel_init*0.5 , rand() * vel_init - vel_init*0.5 ];
			blocks.push( {"pos": pos, "vel": vel} );
			
		}

		// loop
		function simloop() {

			// pre-think
			for (var i = blocks.length - 1; i >= 0; i--) {
				blocks[i].vel[1] += 0.8; // gravity
				var newpos = [blocks[i].pos[0] + blocks[i].vel[0], blocks[i].pos[1] + blocks[i].vel[1]];
				if (newpos[1] > ctx.canvas.height) { // bounce from the floor
					newpos[1] = ctx.canvas.height;
					blocks[i].vel[1] *= -0.7; // energy loss on bounce, -1.0 for no loss
					blocks[i].vel[0] *= friction_flr; // friction
				}
				if (newpos[0] < 0) { // bounce from left wall
					newpos[0] = 0;
					blocks[i].vel[0] *= -0.7; // energy loss on bounce, -1.0 for no loss
					blocks[i].vel[1] *= friction_wall; // friction
				}
				if (newpos[0] > ctx.canvas.width) { // bounce from left wall
					newpos[0] = ctx.canvas.width;
					blocks[i].vel[0] *= -0.7; // energy loss on bounce, -1.0 for no loss
					blocks[i].vel[1] *= friction_wall; // friction
				}

				blocks[i].pos = newpos;

			}

			// draw
			ctx.fillStyle = colors[0]; // clean
			ctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height);

			for (var i = blocks.length - 1; i >= 0; i--) {
				ctx.fillStyle = colors[1];
				ctx.fillRect(blocks[i].pos[0]-block_size/2, blocks[i].pos[1]-block_size/2, block_size, block_size);
			}
		}



	}
	</script>

</head>
<body onload="play()">
<canvas id="area"></canvas>
</body>


</html>
